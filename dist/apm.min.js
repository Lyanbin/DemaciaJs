!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):t.Apm=o()}(this,function(){"use strict";function t(){return""}function o(){return""}function n(){return""}var e={os:t(),browser:o(),vn:n()},i=function(){this.msg=[]};i.prototype.getLength=function(){return this.msg.length},i.prototype.getMsg=function(){return this.msg.join("")},i.prototype.push=function(t){var o=this.getLength();return o&&(this.msg[o-1]+="&"),this.msg.push(t)},i.prototype.pop=function(){var t=this.getLength();if(t){var o=this.msg[t-1].split("");o.pop(),this.msg[t-1]=o.join("")}return this.msg.pop()},i.prototype.clear=function(){this.msg.length=0};var s="undefined"!==window.localStorage,r=function(t){var o=this;if(void 0===t&&(t={url:"http://127.0.0.1:3000"}),this.options=t,this.info=e,this.msg=new i,this.src=t.url+"/apm.gif?",+("_os="+this.info.os+"&")+"_browser="+this.info.browser+"&_vn="+this.info.vn+"&",s){var n=window.localStorage,r=JSON.parse(n.getItem("APM_IS_SENT"));if(null!==r&&!r){var h="APM_MSG_";n.forEach(function(t){t.indexOf(h)&&o.msg.push(n[t])}),this.report(),n.clear()}n.setItem("APM_IS_SENT",!0)}};return r.prototype.report=function(){var t=this,o=new Image(1,1),n=this.msg.getMsg();o.src=this.src+n,o.onload=function(){t.msg.clear(),console.log("done!")},o.onerror=function(){console.log("oh shoop!")}},r});
